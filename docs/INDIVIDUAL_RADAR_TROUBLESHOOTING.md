# 🔧 個別學生雷達圖問題診斷指南

## 🚨 問題描述
您反映個別學生分析的雷達圖沒有成功顯示各階層平均分數。

## 🔍 可能的原因和解決方案

### 1. **資料載入問題**

#### 問題：沒有先在「學生總覽」頁面載入資料
**症狀**: 看到警告訊息 "請先在「學生總覽」頁面載入資料"

**解決方案**:
1. 先進入「學生總覽」頁面
2. 點擊「重新載入 Google Sheet 資料」按鈕
3. 等待資料載入完成
4. 再進入「個別學生分析」頁面

#### 問題：資料載入失敗
**症狀**: 看到錯誤訊息或資料為空

**解決方案**:
1. 檢查 Google Sheets 連接是否正常
2. 確認工作表名稱是否正確
3. 檢查資料格式是否符合要求

### 2. **階層資料問題**

#### 問題：階層欄位缺失或為空
**症狀**: 雷達圖只顯示學生個人資料，沒有階層對比

**解決方案**:
1. 檢查資料中是否有「階層」欄位
2. 確認階層欄位有有效的值（如 C1, C2, PGY, R）
3. 如果階層資料不完整，系統會自動跳過階層對比

### 3. **EPA項目資料問題**

#### 問題：EPA評核項目不足
**症狀**: 雷達圖顯示異常或錯誤

**解決方案**:
1. 確認資料中有「EPA評核項目」欄位
2. 檢查是否有足夠的EPA項目（至少3個）
3. 確認「教師評核EPA等級_數值」欄位存在

### 4. **瀏覽器快取問題**

#### 問題：頁面沒有更新
**症狀**: 看不到新的功能或選項

**解決方案**:
1. 按 Ctrl+F5 (Windows) 或 Cmd+Shift+R (Mac) 強制重新整理
2. 清除瀏覽器快取
3. 重新啟動 Streamlit 應用程式

## 🛠️ 診斷步驟

### 步驟1: 檢查資料載入狀態
```
1. 進入「學生總覽」頁面
2. 查看是否顯示 "成功處理 X 筆EPA資料！"
3. 如果沒有，點擊「重新載入 Google Sheet 資料」
```

### 步驟2: 檢查個別學生分析頁面
```
1. 進入「個別學生分析」頁面
2. 選擇一個學生
3. 查看是否出現雷達圖
4. 檢查是否有「顯示所有階層平均」和「只顯示學生階層」選項
```

### 步驟3: 檢查階層顯示選項
```
1. 確認「顯示所有階層平均」選項已勾選
2. 如果勾選了「只顯示學生階層」，取消勾選
3. 查看雷達圖是否顯示多條線（學生+階層平均）
```

## 🔧 技術修復

### 已修復的問題
1. **全域變數問題**: 修復了 `proceeded_EPA_df` 變數的設置
2. **資料傳遞問題**: 確保個別學生分析能正確獲取完整資料
3. **錯誤處理**: 添加了更好的錯誤處理和警告訊息

### 修復的檔案
- `ugy_epa/ugy_epa_google_sheets.py` - 修復了資料傳遞問題
- `modules/individual_student_radar.py` - 新增了個別學生雷達圖功能

## 📋 檢查清單

### 資料準備
- [ ] 已在「學生總覽」頁面載入資料
- [ ] 資料中包含「階層」欄位
- [ ] 資料中包含「EPA評核項目」欄位
- [ ] 資料中包含「教師評核EPA等級_數值」欄位

### 功能檢查
- [ ] 能看到「顯示所有階層平均」選項
- [ ] 能看到「只顯示學生階層」選項
- [ ] 雷達圖顯示學生個人資料（實心填充）
- [ ] 雷達圖顯示階層平均資料（虛線邊框）
- [ ] 圖例清楚標示各線條代表的內容

### 視覺化檢查
- [ ] 學生資料：實心填充，黑色邊框
- [ ] 階層平均：虛線邊框，不同顏色
- [ ] 圖例：清楚標示各階層
- [ ] 標題：顯示學生姓名和EPA評核雷達圖

## 🚀 如果問題仍然存在

### 1. 檢查 Streamlit 控制台
查看是否有錯誤訊息或警告

### 2. 檢查資料格式
確認 Google Sheets 中的資料格式正確

### 3. 重新啟動應用程式
```bash
# 停止 Streamlit
Ctrl+C

# 重新啟動
streamlit run main_dashboard.py
```

### 4. 聯繫技術支援
如果以上步驟都無法解決問題，請提供：
- 錯誤訊息的截圖
- 資料載入的狀態
- 瀏覽器控制台的錯誤訊息

## 📞 常見問題

### Q: 為什麼看不到階層對比？
A: 請確認：
1. 已在「學生總覽」頁面載入資料
2. 資料中包含「階層」欄位
3. 「顯示所有階層平均」選項已勾選

### Q: 雷達圖只顯示一條線？
A: 這表示只顯示了學生個人資料，請檢查：
1. 階層資料是否完整
2. 階層顯示選項是否正確設置

### Q: 階層顏色不正確？
A: 系統會自動為不同階層分配顏色：
- C1: 紅色
- C2: 藍色  
- PGY: 綠色
- R: 橙色

---

## 🎯 **快速解決方案**

**最常見的問題**: 沒有先在「學生總覽」頁面載入資料

**解決步驟**:
1. 進入「學生總覽」頁面
2. 點擊「重新載入 Google Sheet 資料」
3. 等待載入完成
4. 進入「個別學生分析」頁面
5. 選擇學生並查看雷達圖

**如果仍然有問題，請按照上述診斷步驟逐一檢查！**
