# 🏥 小兒部住院醫師評核系統

## 概述

小兒部住院醫師評核系統是一個整合的評核管理平台，用於記錄和分析小兒部住院醫師的臨床表現。系統與Google Sheets整合，提供即時的資料同步和分析功能。

## 功能特色

### 📊 資料概覽
- 總評核數統計
- 評核病歷數統計
- 評核教師數統計
- 受評核人員數統計
- 評核項目分布圖
- 評核教師分布圖
- 評核時間趨勢圖

### 👥 個別評核分析
- 選擇特定受評核人員
- 個人評核統計
- 評核項目分析
- 評分分析
- 詳細評核資料表格

### 🎯 技能追蹤
- 小兒科住院醫師技能基本要求追蹤
- 個人技能完成進度顯示
- 技能完成次數統計
- 技能完成度視覺化圖表
- 詳細技能記錄查看

### 📈 統計分析
- 整體評分統計
- 各項評分分布箱線圖
- 評核教師分析
- 時間分析（每月評核次數）

### ⚙️ 資料管理
- 重新載入Google表單資料
- 資料匯出（CSV格式）
- 資料驗證（缺失值檢查、重複資料檢查）
- 資料統計摘要

## 表單欄位說明

### 基本資訊
- **時間戳記**: 自動記錄提交時間
- **評核教師**: 進行評核的教師姓名
- **評核日期**: 評核進行的日期
- **受評核人員**: 被評核的住院醫師姓名
- **評核時級職**: 住院醫師的年級（R1-R5, Fellow）
- **評核項目**: 評核的具體項目
- **會議名稱**: 相關會議名稱

### 評核內容
- **內容是否充分**: 5點量表（非常同意到非常不同意）
- **辯證資料的能力**: 5點量表（優秀到需加強）
- **口條、呈現方式是否清晰**: 5點量表（非常同意到非常不同意）
- **是否具開創、建設性的想法**: 5點量表（優秀到需加強）
- **回答提問是否具邏輯、有條有理**: 5點量表（非常同意到非常不同意）
- **會議報告教師回饋**: 文字回饋

### 技術評核
- **病歷號**: 相關病歷號碼
- **評核技術項目**: 具體技術項目
- **鎮靜藥物**: 是否需要使用鎮靜藥物
- **可信賴程度**: 5點量表（需要指導到完全獨立）
- **操作技術教師回饋**: 技術操作相關回饋
- **熟練程度**: 熟練程度評估

## 小兒科住院醫師技能基本要求

### 技能項目清單
1. **插氣管內管** - 訓練期間最少3次
2. **插臍(動靜脈)導管** - 訓練期間最少1次
3. **腰椎穿刺** - PGY2/R1 訓練期間最少3次
4. **插中心靜脈導管(CVC)** - 訓練期間最少3次
5. **肋膜液或是腹水抽取** - 訓練期間最少1次
6. **插胸管** - 訓練期間最少2次
7. **放置動脈導管** - 訓練期間最少2次
8. **經皮式中央靜脈導管(PICC)** - 訓練期間最少3次
9. **腦部超音波** - 訓練期間最少5次
10. **心臟超音波** - 訓練期間最少5次
11. **腹部超音波** - 訓練期間最少5次
12. **腎臟超音波** - 訓練期間最少5次
13. **病歷書寫** - 訓練期間最少10次
14. **NRP** - 訓練期間最少10次

### 技能追蹤功能
- **自動識別**: 系統會自動從「評核技術項目」欄位中識別技能
- **進度追蹤**: 顯示每個技能的完成進度和剩餘次數
- **視覺化**: 使用進度條和圖表顯示技能完成狀況
- **統計分析**: 提供技能完成率統計和趨勢分析

## 評分轉換規則

### 文字評分轉數值
- 非常同意/優秀: 5
- 同意/良好: 4
- 普通: 3
- 不同意/待改進: 2
- 非常不同意/需加強: 1

### 可信賴程度轉數值
- 提取文字中的數字（1-5）

### 熟練程度轉數值
- 熟練/一兩次內完成: 5
- 基本熟練: 4
- 部分熟練: 3
- 初學: 2
- 不熟練/需指導完成: 1

## 安裝與設定

### 1. 環境需求
- Python 3.8+
- Streamlit
- pandas
- plotly
- gspread
- google-auth

### 2. 安裝依賴
```bash
pip install -r requirements.txt
```

### 3. Google Sheets設定
1. 在Google Cloud Console創建服務帳號
2. 下載服務帳號金鑰JSON檔案
3. 將金鑰檔案放置在專案目錄中
4. 在Streamlit Secrets中設定Google API憑證

### 4. 執行系統
```bash
streamlit run new_dashboard.py
```

## 使用說明

### 1. 存取系統
- 開啟瀏覽器前往 `http://localhost:8501`
- 使用適當的帳號登入系統

### 2. 查看小兒部評核功能
- 在左邊側邊欄的「科別選擇」中選擇「小兒部」
- 點擊「住院醫師」分頁
- 系統會自動載入Google Sheets中的資料並顯示小兒部評核系統

### 3. 資料分析
- **資料概覽**: 查看整體統計資訊
- **個別評核分析**: 選擇特定人員進行分析，包含技能完成狀況
- **技能追蹤**: 詳細追蹤各項技能的完成進度
- **統計分析**: 查看整體評分分布和趨勢
- **資料管理**: 管理資料載入和匯出

### 4. 技能追蹤功能
- **技能標題**: 每個技能項目都有清楚的標題顯示
- **技能描述**: 顯示該技能的基本要求說明
- **完成進度**: 視覺化進度條顯示完成百分比
- **狀態指示**: 清楚標示已完成或還需完成的次數
- **統計數據**: 顯示已完成次數和需要完成次數

### 5. 表單填寫
- 使用提供的HTML表單填寫評核資料
- 表單會自動驗證必填欄位
- 提交後資料會同步到Google Sheets

## 檔案結構

```
CBME_python/
├── pediatric_evaluation.py          # 主要評核系統模組
├── test_pediatric_evaluation.py     # 測試腳本
├── pediatric_form.html              # HTML表單
├── new_dashboard.py                 # 主儀表板（已更新）
└── PEDIATRIC_EVALUATION_README.md   # 說明文件
```

## 技術架構

### 前端
- Streamlit: 主要UI框架
- Plotly: 圖表視覺化
- HTML/CSS/JavaScript: 表單介面

### 後端
- Python: 主要程式語言
- pandas: 資料處理
- gspread: Google Sheets API整合

### 資料儲存
- Google Sheets: 主要資料儲存
- 本地CSV匯出功能

## 故障排除

### 常見問題

1. **無法載入Google Sheets資料**
   - 檢查Google API憑證設定
   - 確認服務帳號權限
   - 檢查網路連接

2. **表單提交失敗**
   - 檢查必填欄位是否完整
   - 確認Google Sheets權限設定

3. **圖表顯示異常**
   - 檢查資料格式
   - 確認評分轉換是否正確

### 除錯模式
啟用除錯模式以查看詳細的錯誤訊息：
```python
# 在 pediatric_evaluation.py 中設定
SHOW_DIAGNOSTICS = True
```

## 更新日誌

### v1.0.0 (2025-01-XX)
- 初始版本發布
- 基本評核功能
- Google Sheets整合
- 資料視覺化
- 表單介面

## 聯絡資訊

如有問題或建議，請聯絡系統管理員。

---

**注意**: 本系統僅供內部使用，請確保資料安全和隱私保護。
