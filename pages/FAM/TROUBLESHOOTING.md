# 家醫部系統故障排除指南

## 🚨 常見問題解決方案

### 問題1：系統顯示「沒有可用的資料」

**症狀：**
- 已經上傳了家醫部資料檔案
- 顯示「家醫部檔案合併成功！」
- 但進入家醫部系統後顯示「沒有可用的資料」

**解決方案：**

#### 方法1：檢查資料傳遞
1. 在家醫部系統頁面開啟「🔧 調試模式」
2. 查看調試資訊，確認資料是否正確載入
3. 如果看到「從 fam_data 載入資料」或「從 家醫部_data 載入資料」，表示資料傳遞正常

#### 方法2：重新上傳資料
1. 回到左側側邊欄
2. 確認已選擇「家醫部」科別
3. 重新上傳EPA評核資料檔案
4. 點擊「合併家醫部檔案」按鈕
5. 確認看到「家醫部檔案合併成功！」訊息
6. 重新進入「住院醫師」分頁

#### 方法3：使用診斷工具
1. 如果問題持續，可以使用診斷工具：
```python
# 在系統中運行
from pages.FAM.diagnostic_tool import show_diagnostic_tool
show_diagnostic_tool()
```

### 問題2：資料顯示不完整

**症狀：**
- 資料載入成功，但某些功能無法使用
- 圖表顯示異常
- 學員或EPA項目清單為空

**解決方案：**

1. **檢查資料格式**
   - 確認CSV/Excel檔案包含所有必要欄位
   - 檢查日期格式是否正確
   - 確認EPA項目名稱符合標準格式

2. **檢查資料內容**
   - 開啟調試模式查看資料清理過程
   - 確認資料清理後仍有有效記錄
   - 檢查學員姓名和EPA項目是否為空

3. **重新處理資料**
   - 重新上傳資料檔案
   - 確保檔案沒有損壞或格式錯誤

### 問題3：EPA項目無法識別

**症狀：**
- EPA項目追蹤功能異常
- 無法計算EPA完成進度
- EPA項目清單顯示不正確

**解決方案：**

系統支援以下EPA項目格式：
- `02門診/社區衛教`
- `03預防注射`
- `05健康檢查`
- `07慢病照護`
- `08急症照護`
- `09居家整合醫療`
- `11末病照護/安寧緩和`
- `12家庭醫學科住院照護`
- `13家庭醫學科門診照護`
- `14社區醫學實習`
- `15預防醫學與健康促進`
- `16家庭醫學科急診照護`
- `17長期照護`
- `18家庭醫學科研習`

如果您的EPA項目名稱不同，請：
1. 檢查原始資料中的EPA項目名稱
2. 確認是否與標準格式一致
3. 如有必要，修改資料檔案中的EPA項目名稱

### 問題4：信賴程度評估異常

**症狀：**
- 信賴程度分析無法顯示
- 信賴程度圖表異常
- 無法計算平均信賴程度

**解決方案：**

系統支援以下信賴程度等級：
- `獨立執行`
- `必要時知會教師確認`
- `教師在旁必要時協助`
- `教師在旁逐步共同操作`
- `學員在旁觀察`
- `不允許學員觀察`

請確認：
1. 信賴程度欄位名稱正確：`信賴程度(教師評量)`
2. 信賴程度值與標準格式一致
3. 資料中沒有空值或格式錯誤

## 🔧 調試工具使用

### 調試模式
在家醫部系統頁面開啟「🔧 調試模式」可以查看：
- Session state中的資料狀態
- 資料載入和清理過程
- 原始資料形狀和欄位
- 清理後資料的詳細資訊

### 診斷工具
使用診斷工具可以：
- 檢查所有session state中的資料
- 驗證資料傳遞是否正常
- 提供自動修復建議
- 預覽資料內容

## 📞 技術支援

如果以上方法都無法解決問題，請：

1. **收集錯誤資訊**
   - 開啟調試模式
   - 截圖錯誤訊息
   - 記錄操作步驟

2. **聯繫技術支援**
   - 提供錯誤截圖
   - 說明操作步驟
   - 附上資料檔案範例（去除敏感資訊）

3. **提供系統資訊**
   - 瀏覽器版本
   - 作業系統
   - 資料檔案大小和格式

## 🔄 系統更新

系統會定期更新以修復已知問題：
- 改善資料載入穩定性
- 優化資料清理邏輯
- 新增更多EPA項目支援
- 修復視覺化問題

---

**最後更新**：2025年1月  
**版本**：1.0.0
